apiVersion: v1
kind: ConfigMap
metadata:
  name: bobrapet-operator-config
  namespace: bobrapet-system
data:
  # ====================
  # Global Controller Configuration
  # ====================
  controller.max-concurrent-reconciles: "10"
  controller.requeue-base-delay: "2s"
  controller.requeue-max-delay: "1m"
  controller.health-check-interval: "30s"
  controller.cleanup-interval: "1h"
  controller.reconcile-timeout: "1m"
  controller.default-engram-grpc-port: "50051"
  controller.max-story-with-block-size-bytes: "65536"
  
  # ====================
  # Image Configuration  
  # ====================
  images.registry: "ghcr.io/bubustack"
  images.default-engram: "engram-default:latest"
  images.default-impulse: "impulse-default:latest"
  images.pull-policy: "IfNotPresent"
  
  # ====================
  # Default Resource Limits
  # ====================
  resources.default.cpu-request: "100m"
  resources.default.cpu-limit: "500m"
  resources.default.memory-request: "128Mi"
  resources.default.memory-limit: "512Mi"
  
  # ====================
  # Engram-Specific Resource Limits
  # ====================
  resources.engram.cpu-request: "100m"
  resources.engram.cpu-limit: "1"
  resources.engram.memory-request: "128Mi"
  resources.engram.memory-limit: "512Mi"
  
  # ====================
  # Retry and Timeout Configuration
  # ====================
  retry.max-retries: "3"
  retry.exponential-backoff-base: "1s"
  retry.exponential-backoff-max: "60s"
  timeout.default-step: "5m"
  timeout.approval-default: "24h"
  timeout.external-data-default: "30m"
  timeout.conditional-default: "10m"
  
  # ====================
  # Loop Processing Configuration
  # ====================
  loop.max-iterations: "10000"
  loop.default-batch-size: "100"
  loop.max-batch-size: "1000"
  loop.max-concurrency: "10"
  loop.max-concurrency-limit: "50"
  
  # ====================
  # Security Configuration
  # ====================
  security.run-as-non-root: "true"
  security.read-only-root-filesystem: "true"
  security.allow-privilege-escalation: "false"
  security.drop-capabilities: "ALL"
  security.run-as-user: "1000"
  security.automount-service-account-token: "false"
  security.service-account-name: "default"
  
  # ====================
  # Job Configuration
  # ====================
  job.backoff-limit: "3"
  job.ttl-seconds-after-finished: "3600"
  job.restart-policy: "Never"
  
  # ====================
  # CEL Configuration
  # ====================
  cel.evaluation-timeout: "30s"
  cel.max-expression-length: "1000"
  cel.enable-macros: "true"
  
  # ====================
  # Telemetry Configuration
  # ====================
  telemetry.enabled: "true"
  telemetry.trace-propagation: "true"
  
  # ====================
  # Development/Debug Configuration
  # ====================
  debug.enable-verbose-logging: "false"
  debug.enable-step-output-logging: "false"
  debug.enable-metrics: "true"
  
  # ====================
  # StoryRun Controller Configuration
  # ====================
  storyrun.max-concurrent-reconciles: "8"
  storyrun.rate-limiter.base-delay: "50ms"
  storyrun.rate-limiter.max-delay: "5m"
  storyrun.max-inline-inputs-size: "1024"
  
  # ====================
  # StepRun Controller Configuration
  # ====================
  steprun.max-concurrent-reconciles: "15"
  steprun.rate-limiter.base-delay: "100ms"
  steprun.rate-limiter.max-delay: "2m"
  
  # ====================
  # Story Controller Configuration
  # ====================
  story.max-concurrent-reconciles: "5"
  story.rate-limiter.base-delay: "200ms"
  story.rate-limiter.max-delay: "1m"
  
  # ====================
  # Engram Controller Configuration
  # ====================
  engram.max-concurrent-reconciles: "5"
  engram.rate-limiter.base-delay: "200ms"
  engram.rate-limiter.max-delay: "1m"
  engram.default-max-inline-size: "1024"
  engram.default-grpc-port: "50051"
  engram.default-storage-timeout-seconds: "300"
  engram.default-graceful-shutdown-timeout-seconds: "20"
  engram.default-termination-grace-period-seconds: "30"
  engram.default-max-recv-msg-bytes: "10485760"
  engram.default-max-send-msg-bytes: "10485760"
  engram.default-dial-timeout-seconds: "10"
  engram.default-channel-buffer-size: "16"
  engram.default-reconnect-max-retries: "10"
  engram.default-reconnect-base-backoff-millis: "500"
  engram.default-reconnect-max-backoff-seconds: "30"
  engram.default-hang-timeout-seconds: "30"
  engram.default-message-timeout-seconds: "30"
  
  # ====================
  # Impulse Controller Configuration
  # ====================
  impulse.max-concurrent-reconciles: "5"
  impulse.rate-limiter.base-delay: "200ms"
  impulse.rate-limiter.max-delay: "1m"
  
  # ====================
  # Template Controller Configuration
  # ====================
  template.max-concurrent-reconciles: "2"
  template.rate-limiter.base-delay: "500ms"
  template.rate-limiter.max-delay: "10m"
